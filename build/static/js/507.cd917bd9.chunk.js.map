{"version":3,"file":"static/js/507.cd917bd9.chunk.js","mappings":"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","sources":["dashboard/pages/organization/OrganizationDashboard.js"],"sourcesContent":["/**\n * Organization Management Dashboard\n * \n * Phase 2 feature for managing pharmacy chains/groups.\n * Allows chain admins to:\n * - View organization details\n * - Manage member facilities\n * - Sync admin permissions\n * - View cross-facility reports\n */\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport PropTypes from 'prop-types';\nimport { useTranslation } from 'react-i18next';\nimport { httpsCallable } from 'firebase/functions';\nimport { collection, query, where, getDocs } from 'firebase/firestore';\nimport { functions, db } from '../../../services/firebase';\nimport { useAuth } from '../../../contexts/AuthContext';\nimport { useNotification } from '../../../contexts/NotificationContext';\nimport {\n    FiUsers,\n    FiSettings,\n    FiPlus,\n    FiLink,\n    FiX,\n    FiHome,\n    FiShield,\n    FiRefreshCw,\n    FiCheck\n} from 'react-icons/fi';\nimport { cn } from '../../../utils/cn';\n\nconst OrganizationDashboard = () => {\n    const { t } = useTranslation(['organization', 'common']);\n    const { currentUser } = useAuth();\n    const { showNotification } = useNotification();\n\n    const [organization, setOrganization] = useState(null);\n    const [memberFacilities, setMemberFacilities] = useState([]);\n    const [isLoading, setIsLoading] = useState(true);\n    const [isCreating, setIsCreating] = useState(false);\n    const [showCreateModal, setShowCreateModal] = useState(false);\n    const [newOrgName, setNewOrgName] = useState('');\n\n    // Fetch organization data\n    const fetchOrganization = useCallback(async () => {\n        if (!currentUser) return;\n\n        setIsLoading(true);\n        try {\n            // Check if user is admin of any organization\n            const orgsQuery = query(\n                collection(db, 'organizations'),\n                where('admins', 'array-contains', currentUser.uid)\n            );\n            const orgsSnapshot = await getDocs(orgsQuery);\n\n            if (!orgsSnapshot.empty) {\n                const orgDoc = orgsSnapshot.docs[0];\n                const orgData = { id: orgDoc.id, ...orgDoc.data() };\n                setOrganization(orgData);\n\n                // Fetch member facilities\n                if (orgData.memberFacilityIds?.length > 0) {\n                    const facilitiesPromises = orgData.memberFacilityIds.map(async (facilityId) => {\n                        const facilityQuery = query(\n                            collection(db, 'facilityProfiles'),\n                            where('__name__', '==', facilityId)\n                        );\n                        const facilitySnapshot = await getDocs(facilityQuery);\n                        if (!facilitySnapshot.empty) {\n                            return { id: facilitySnapshot.docs[0].id, ...facilitySnapshot.docs[0].data() };\n                        }\n                        return null;\n                    });\n\n                    const facilities = (await Promise.all(facilitiesPromises)).filter(Boolean);\n                    setMemberFacilities(facilities);\n                }\n            } else {\n                // Check if user's facility is part of an organization\n                const facilityQuery = query(\n                    collection(db, 'facilityProfiles'),\n                    where('__name__', '==', currentUser.uid)\n                );\n                const facilitySnapshot = await getDocs(facilityQuery);\n\n                if (!facilitySnapshot.empty) {\n                    const facilityData = facilitySnapshot.docs[0].data();\n                    if (facilityData.organizationId) {\n                        // Fetch the organization\n                        const orgQuery = query(\n                            collection(db, 'organizations'),\n                            where('__name__', '==', facilityData.organizationId)\n                        );\n                        const orgSnapshot = await getDocs(orgQuery);\n                        if (!orgSnapshot.empty) {\n                            setOrganization({ id: orgSnapshot.docs[0].id, ...orgSnapshot.docs[0].data() });\n                        }\n                    }\n                }\n            }\n        } catch (error) {\n            console.error('Error fetching organization:', error);\n            showNotification(t('organization:errors.fetchFailed', 'Failed to load organization'), 'error');\n        } finally {\n            setIsLoading(false);\n        }\n    }, [currentUser, showNotification, t]);\n\n    useEffect(() => {\n        fetchOrganization();\n    }, [fetchOrganization]);\n\n    // Create new organization\n    const handleCreateOrganization = async () => {\n        if (!newOrgName.trim()) {\n            showNotification(t('organization:errors.nameRequired', 'Organization name is required'), 'warning');\n            return;\n        }\n\n        setIsCreating(true);\n        try {\n            const createOrgFn = httpsCallable(functions, 'createOrganization');\n            const result = await createOrgFn({\n                name: newOrgName,\n                type: 'group',\n                initialFacilityIds: [currentUser.uid],\n                settings: {\n                    sharedStaffPool: true,\n                    crossFacilityScheduling: true\n                }\n            });\n\n            if (result.data.success) {\n                showNotification(t('organization:success.created', 'Organization created successfully!'), 'success');\n                setShowCreateModal(false);\n                setNewOrgName('');\n                fetchOrganization();\n            }\n        } catch (error) {\n            console.error('Error creating organization:', error);\n            showNotification(error.message || t('organization:errors.createFailed', 'Failed to create organization'), 'error');\n        } finally {\n            setIsCreating(false);\n        }\n    };\n\n\n    // Remove facility from organization\n    const handleRemoveFacility = async (facilityId) => {\n        if (!window.confirm(t('organization:confirm.removeFacility', 'Remove this facility from the organization?'))) {\n            return;\n        }\n\n        try {\n            const removeFacilityFn = httpsCallable(functions, 'removeFacilityFromOrganization');\n            const result = await removeFacilityFn({\n                organizationId: organization.id,\n                facilityId\n            });\n\n            if (result.data.success) {\n                showNotification(t('organization:success.facilityRemoved', 'Facility removed successfully!'), 'success');\n                fetchOrganization();\n            }\n        } catch (error) {\n            console.error('Error removing facility:', error);\n            showNotification(error.message || t('organization:errors.removeFacilityFailed', 'Failed to remove facility'), 'error');\n        }\n    };\n\n    // Check if current user is org admin\n    const isOrgAdmin = organization?.admins?.includes(currentUser?.uid);\n\n    // Facility Card Component\n    const FacilityCard = ({ facility, canRemove }) => (\n        <div className=\"bg-card border border-border rounded-xl p-5 hover:shadow-md transition-shadow\">\n            <div className=\"flex items-start justify-between\">\n                <div className=\"flex items-center gap-3\">\n                    <div className=\"p-2.5 rounded-lg bg-primary/10 text-primary\">\n                        <FiHome className=\"w-5 h-5\" />\n                    </div>\n                    <div>\n                        <h4 className=\"font-medium text-foreground\">\n                            {facility.facilityName || facility.companyName || t('organization:labels.unnamedFacility')}\n                        </h4>\n                        <p className=\"text-sm text-muted-foreground\">\n                            {facility.address?.city}, {facility.address?.canton}\n                        </p>\n                        {facility.glnNumber && (\n                            <p className=\"text-xs text-muted-foreground mt-1\">\n                                GLN: {facility.glnNumber}\n                            </p>\n                        )}\n                    </div>\n                </div>\n                {canRemove && (\n                    <button\n                        onClick={() => handleRemoveFacility(facility.id)}\n                        className=\"p-2 text-muted-foreground hover:text-red-500 hover:bg-red-50 rounded-lg transition-colors\"\n                        title={t('organization:actions.remove', 'Remove from organization')}\n                    >\n                        <FiX className=\"w-4 h-4\" />\n                    </button>\n                )}\n            </div>\n\n            {/* Chain Admin Badge */}\n            {facility.chainAdmins?.length > 0 && (\n                <div className=\"mt-3 pt-3 border-t border-border\">\n                    <div className=\"flex items-center gap-2 text-xs text-green-600\">\n                        <FiShield className=\"w-3.5 h-3.5\" />\n                        <span>{t('organization:labels.chainAdminsSynced', 'Chain admins synced')}</span>\n                    </div>\n                </div>\n            )}\n        </div>\n    );\n\n    FacilityCard.propTypes = {\n        facility: PropTypes.shape({\n            id: PropTypes.string,\n            facilityName: PropTypes.string,\n            companyName: PropTypes.string,\n            address: PropTypes.shape({\n                city: PropTypes.string,\n                canton: PropTypes.string\n            }),\n            glnNumber: PropTypes.string,\n            chainAdmins: PropTypes.array\n        }).isRequired,\n        canRemove: PropTypes.bool.isRequired\n    };\n\n    // Create Organization Modal\n    const CreateOrgModal = () => (\n        <div className=\"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4\">\n            <div className=\"bg-card rounded-xl shadow-xl max-w-md w-full\">\n                <div className=\"p-6 border-b border-border\">\n                    <h3 className=\"text-xl font-semibold text-foreground\">\n                        {t('organization:create.title', 'Create Organization')}\n                    </h3>\n                    <p className=\"text-sm text-muted-foreground mt-1\">\n                        {t('organization:create.subtitle', 'Create a new pharmacy chain or group')}\n                    </p>\n                </div>\n\n                <div className=\"p-6\">\n                    <label className=\"block text-sm font-medium text-foreground mb-2\">\n                        {t('organization:create.nameLabel', 'Organization Name')}\n                    </label>\n                    <input\n                        type=\"text\"\n                        value={newOrgName}\n                        onChange={(e) => setNewOrgName(e.target.value)}\n                        placeholder={t('organization:create.namePlaceholder', 'e.g., Amavita Geneva Group')}\n                        className=\"w-full px-4 py-2.5 rounded-lg border border-border bg-background text-foreground focus:ring-2 focus:ring-primary/20 focus:border-primary outline-none transition-all\"\n                    />\n                </div>\n\n                <div className=\"p-6 border-t border-border flex gap-3 justify-end\">\n                    <button\n                        onClick={() => setShowCreateModal(false)}\n                        className=\"px-4 py-2 text-muted-foreground hover:text-foreground transition-colors\"\n                    >\n                        {t('common:cancel', 'Cancel')}\n                    </button>\n                    <button\n                        onClick={handleCreateOrganization}\n                        disabled={isCreating || !newOrgName.trim()}\n                        className={cn(\n                            \"px-4 py-2 bg-primary text-primary-foreground rounded-lg font-medium\",\n                            \"hover:bg-primary/90 transition-colors\",\n                            (isCreating || !newOrgName.trim()) && \"opacity-50 cursor-not-allowed\"\n                        )}\n                    >\n                        {isCreating ? (\n                            <span className=\"flex items-center gap-2\">\n                                <FiRefreshCw className=\"w-4 h-4 animate-spin\" />\n                                {t('common:creating', 'Creating...')}\n                            </span>\n                        ) : (\n                            t('common:create', 'Create')\n                        )}\n                    </button>\n                </div>\n            </div>\n        </div>\n    );\n\n    // Empty State\n    const EmptyState = () => (\n        <div className=\"text-center py-16\">\n            <div className=\"w-20 h-20 mx-auto mb-6 rounded-full bg-primary/10 flex items-center justify-center\">\n                <FiUsers className=\"w-10 h-10 text-primary\" />\n            </div>\n            <h3 className=\"text-xl font-semibold text-foreground mb-2\">\n                {t('organization:empty.title', 'No Organization Yet')}\n            </h3>\n            <p className=\"text-muted-foreground max-w-md mx-auto mb-6\">\n                {t('organization:empty.description', 'Create an organization to manage multiple pharmacy locations, share staff, and consolidate billing.')}\n            </p>\n            <button\n                onClick={() => setShowCreateModal(true)}\n                className=\"inline-flex items-center gap-2 px-6 py-3 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors\"\n            >\n                <FiPlus className=\"w-4 h-4\" />\n                {t('organization:actions.create', 'Create Organization')}\n            </button>\n        </div>\n    );\n\n    return (\n        <div className=\"h-full flex flex-col overflow-hidden animate-in fade-in duration-500\">\n            {/* Header */}\n            <div className=\"shrink-0 p-6 border-b border-border bg-card/50\">\n                <div className=\"flex items-center justify-between\">\n                    <div>\n                        <h1 className=\"text-2xl font-bold text-foreground\">\n                            {organization?.name || t('organization:title', 'Organization')}\n                        </h1>\n                        <p className=\"text-muted-foreground mt-1\">\n                            {organization\n                                ? t('organization:subtitle', 'Manage your pharmacy chain')\n                                : t('organization:noOrg', 'Create or join an organization')\n                            }\n                        </p>\n                    </div>\n                    {organization && (\n                        <button\n                            onClick={fetchOrganization}\n                            disabled={isLoading}\n                            className={cn(\n                                \"flex items-center gap-2 px-4 py-2 rounded-lg border border-border\",\n                                \"hover:bg-muted transition-colors\",\n                                isLoading && \"opacity-50 cursor-not-allowed\"\n                            )}\n                        >\n                            <FiRefreshCw className={cn(\"w-4 h-4\", isLoading && \"animate-spin\")} />\n                            {t('common:refresh', 'Refresh')}\n                        </button>\n                    )}\n                </div>\n            </div>\n\n            {/* Content */}\n            <div className=\"flex-1 overflow-auto p-6\">\n                {isLoading ? (\n                    <div className=\"flex items-center justify-center py-16\">\n                        <div className=\"w-8 h-8 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\n                    </div>\n                ) : !organization ? (\n                    <EmptyState />\n                ) : (\n                    <div className=\"space-y-6\">\n                        {/* Organization Info Card */}\n                        <div className=\"bg-card border border-border rounded-xl p-6\">\n                            <div className=\"flex items-center justify-between mb-4\">\n                                <h3 className=\"text-lg font-semibold text-foreground\">\n                                    {t('organization:sections.info', 'Organization Info')}\n                                </h3>\n                                {isOrgAdmin && (\n                                    <button className=\"text-sm text-primary hover:text-primary/80 flex items-center gap-1\">\n                                        <FiSettings className=\"w-4 h-4\" />\n                                        {t('common:settings', 'Settings')}\n                                    </button>\n                                )}\n                            </div>\n\n                            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n                                <div className=\"p-4 bg-muted/30 rounded-lg\">\n                                    <p className=\"text-sm text-muted-foreground\">{t('organization:labels.type', 'Type')}</p>\n                                    <p className=\"font-medium capitalize\">{organization.type || t('organization:labels.group')}</p>\n                                </div>\n                                <div className=\"p-4 bg-muted/30 rounded-lg\">\n                                    <p className=\"text-sm text-muted-foreground\">{t('organization:labels.facilities', 'Facilities')}</p>\n                                    <p className=\"font-medium\">{memberFacilities.length}</p>\n                                </div>\n                                <div className=\"p-4 bg-muted/30 rounded-lg\">\n                                    <p className=\"text-sm text-muted-foreground\">{t('organization:labels.admins', 'Admins')}</p>\n                                    <p className=\"font-medium\">{organization.admins?.length || 0}</p>\n                                </div>\n                            </div>\n\n                            {/* Settings */}\n                            <div className=\"mt-4 pt-4 border-t border-border\">\n                                <div className=\"flex flex-wrap gap-3\">\n                                    {organization.settings?.sharedStaffPool && (\n                                        <span className=\"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-transparent text-green-700 border border-green-700\">\n                                            <FiCheck className=\"w-3 h-3\" />\n                                            {t('organization:settings.sharedStaff', 'Shared Staff Pool')}\n                                        </span>\n                                    )}\n                                    {organization.settings?.crossFacilityScheduling && (\n                                        <span className=\"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-transparent text-blue-700 border border-blue-700\">\n                                            <FiCheck className=\"w-3 h-3\" />\n                                            {t('organization:settings.crossScheduling', 'Cross-Facility Scheduling')}\n                                        </span>\n                                    )}\n                                    {organization.settings?.consolidatedBilling && (\n                                        <span className=\"inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-medium bg-transparent text-purple-700 border border-purple-700\">\n                                            <FiCheck className=\"w-3 h-3\" />\n                                            {t('organization:settings.consolidatedBilling', 'Consolidated Billing')}\n                                        </span>\n                                    )}\n                                </div>\n                            </div>\n                        </div>\n\n                        {/* Member Facilities */}\n                        <div className=\"bg-card border border-border rounded-xl p-6\">\n                            <div className=\"flex items-center justify-between mb-4\">\n                                <h3 className=\"text-lg font-semibold text-foreground\">\n                                    {t('organization:sections.facilities', 'Member Facilities')}\n                                    {memberFacilities.length > 0 && (\n                                        <span className=\"ml-2 text-sm font-normal text-muted-foreground\">\n                                            ({memberFacilities.length})\n                                        </span>\n                                    )}\n                                </h3>\n                                {isOrgAdmin && (\n                                    <button\n                                        className=\"flex items-center gap-2 px-4 py-2 bg-primary text-primary-foreground rounded-lg font-medium text-sm hover:bg-primary/90 transition-colors\"\n                                    >\n                                        <FiLink className=\"w-4 h-4\" />\n                                        {t('organization:actions.addFacility', 'Add Facility')}\n                                    </button>\n                                )}\n                            </div>\n\n                            {memberFacilities.length === 0 ? (\n                                <div className=\"text-center py-8 text-muted-foreground\">\n                                    {t('organization:facilities.empty', 'No facilities in this organization yet.')}\n                                </div>\n                            ) : (\n                                <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\">\n                                    {memberFacilities.map((facility) => (\n                                        <FacilityCard\n                                            key={facility.id}\n                                            facility={facility}\n                                            canRemove={isOrgAdmin && memberFacilities.length > 1}\n                                        />\n                                    ))}\n                                </div>\n                            )}\n                        </div>\n\n                        {/* Feature Cards */}\n                        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                            {/* Internal Interim */}\n                            <div className=\"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6\">\n                                <div className=\"flex items-center gap-3 mb-3\">\n                                    <div className=\"p-2 rounded-lg bg-blue-100 text-blue-600\">\n                                        <FiUsers className=\"w-5 h-5\" />\n                                    </div>\n                                    <h4 className=\"font-semibold text-blue-900\">\n                                        {t('organization:features.internalInterim.title', 'Internal Interim')}\n                                    </h4>\n                                </div>\n                                <p className=\"text-sm text-blue-700\">\n                                    {t('organization:features.internalInterim.description', 'Share staff between facilities. When understaffed, borrow workers from other locations in your organization first.')}\n                                </p>\n                            </div>\n\n                            {/* Cross-Facility Reports */}\n                            <div className=\"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6\">\n                                <div className=\"flex items-center gap-3 mb-3\">\n                                    <div className=\"p-2 rounded-lg bg-purple-100 text-purple-600\">\n                                        <FiHome className=\"w-5 h-5\" />\n                                    </div>\n                                    <h4 className=\"font-semibold text-purple-900\">\n                                        {t('organization:features.crossReports.title', 'Cross-Facility Reports')}\n                                    </h4>\n                                </div>\n                                <p className=\"text-sm text-purple-700\">\n                                    {t('organization:features.crossReports.description', 'Track hours borrowed between locations. View consolidated reports for the entire organization.')}\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                )}\n            </div>\n\n            {/* Modals */}\n            {showCreateModal && <CreateOrgModal />}\n        </div>\n    );\n};\n\nexport default OrganizationDashboard;\n"],"names":["OrganizationDashboard","_organization$admins","_organization$admins2","_organization$setting","_organization$setting2","_organization$setting3","t","useTranslation","currentUser","useAuth","showNotification","useNotification","organization","setOrganization","useState","memberFacilities","setMemberFacilities","isLoading","setIsLoading","isCreating","setIsCreating","showCreateModal","setShowCreateModal","newOrgName","setNewOrgName","fetchOrganization","useCallback","async","orgsQuery","query","collection","db","where","uid","orgsSnapshot","getDocs","empty","facilityQuery","facilitySnapshot","facilityData","docs","data","organizationId","orgQuery","orgSnapshot","_objectSpread","id","_orgData$memberFacili","orgDoc","orgData","memberFacilityIds","length","facilitiesPromises","map","facilityId","facilities","Promise","all","filter","Boolean","error","console","useEffect","handleCreateOrganization","trim","createOrgFn","httpsCallable","functions","name","type","initialFacilityIds","settings","sharedStaffPool","crossFacilityScheduling","success","message","isOrgAdmin","admins","includes","FacilityCard","_ref","_facility$address","_facility$address2","_facility$chainAdmins","facility","canRemove","_jsxs","className","children","_jsx","FiHome","facilityName","companyName","address","city","canton","glnNumber","onClick","window","confirm","removeFacilityFn","handleRemoveFacility","title","FiX","chainAdmins","FiShield","CreateOrgModal","value","onChange","e","target","placeholder","disabled","cn","FiRefreshCw","EmptyState","FiUsers","FiPlus","FiSettings","FiCheck","consolidatedBilling","FiLink"],"ignoreList":[],"sourceRoot":""}